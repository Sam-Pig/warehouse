var initialBarrage=[];initialBarrage[1]="hello world",initialBarrage[2]="4564fafsdf",initialBarrage[4]=["444","4444444444","44444444444444444","444444444444444444444444444"],initialBarrage[6]="djjjjjjjjjjdjjjjjjjjjjjjjjjjjjjjjjjjjjjjjj",initialBarrage[7]="111111111111111111111111111111111111111111111111111111111",initialBarrage[8]=["88","8","888888888888888888888888888","88888","88888888888888888888888888888888888888888888888"],initialBarrage[20]=["qqqqqq","qqqqq","qqqqqqqqqqqqqqqqqqq","q","qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"],initialBarrage[35]=["www","ww","wwwwwwwwwwwww","ww","wwwwwww"],initialBarrage[50]=["eeee","e","eeeeeeeeeee","eeeee","eeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"],initialBarrage[70]=["rrr","r","rrrrrrrrrrrrrrrrrrrrrr","r"],initialBarrage[100]=["yy","y","yyyyyy"],initialBarrage[120]=["120","120120","120120120120120120","1201","120120120120120120120120120120120120120120120120120120120120"];var tempDanmu=[];$(document).ready(function(){function i(){return"#"+(16777215*Math.random()<<0).toString(16)}function n(){return Math.random()*($("#initialDanmu")[0].clientHeight-50)}function t(i){return Number((10*(1-i/($("#initialDanmu")[0].clientWidth+i))).toFixed(1))}var e,a,r,l,s,o,c,u=!0;$("#Display")[0].addEventListener("play",function(){for(var u=0;u<$("#initialDanmu").children().length;u++){var q=$("#initialDanmu").children()[u].clientWidth,m=Number((10*(1-q/($("#initialDanmu")[0].clientWidth+q))).toFixed(1)),d=(1-($("#initialDanmu")[0].getBoundingClientRect().right-$("#initialDanmu").children()[u].getBoundingClientRect().left)/($("#initialDanmu")[0].clientWidth+q))*m;$($("#initialDanmu").children()[u]).css("transform","translateX(-"+Math.ceil($("#initialDanmu")[0].clientWidth+$("#initialDanmu").children()[u].clientWidth+10)+"px)"),$($("#initialDanmu").children()[u]).css("transition","transform "+d+"s linear")}s=setInterval(function(){e=Math.floor($("#Display")[0].currentTime),(a=initialBarrage.slice(e,e+1))[0]instanceof Array&&(a=a[0]),a.forEach(function(a,s){r="initialData_"+e+"_"+s,$("#initialDanmu").append("<p style = 'position: absolute;left: 100%;font-size: 24px;' class='initialData "+r+"'>"+$.trim(a)+"</p>"),l=document.getElementsByClassName(r)[0],o=i(),c=n();var u={transition:"transform "+t(l.clientWidth)+"s linear",transform:"translateX(-"+Math.ceil($("#initialDanmu")[0].clientWidth+l.clientWidth+10)+"px)",color:o,top:c+"px"};$(l).css(u)});for(var s=0;s<$("#initialDanmu").children().length;s++){$("#initialDanmu").children()[s].getBoundingClientRect().right-$("#initialDanmu")[0].getBoundingClientRect().left<0&&$("#initialDanmu").children()[s].remove()}},1e3)}),$("#Display")[0].addEventListener("pause",function(){clearInterval(s),e=Math.floor($("#Display")[0].currentTime);for(var i=0;i<$("#initialDanmu").children().length;i++){var n=$("#initialDanmu")[0].getBoundingClientRect().right-$("#initialDanmu").children()[i].getBoundingClientRect().left;$($("#initialDanmu").children()[i]).css("transform","translateX(-"+n+"px)")}}),$("#Display")[0].addEventListener("seeked",function(){clearInterval(s);for(var i=0;i<$("#initialDanmu").children().length;i++)$("#initialDanmu").children()[i].remove()}),$("#send").click(function(){if($.trim($("#input").val())){var e=$.trim($("#input").val()),a=Math.floor($("#Display")[0].currentTime);if(initialDanmu[a]){initialDanmu[a].push(e);var r=initialDanmu[a].length-1}else{initialDanmu[a]=[],initialDanmu[a].push(e);r=0}var l="initialData_"+a+"_"+r;$("#initialDanmu").append("<p style = 'position: absolute;left: 100%;font-size: 24px;' class='initialData "+l+"'>"+$.trim(e)+"</p>");var s=document.getElementsByClassName(l)[0],o=i(),c=n(),u={transition:"transform "+t(s.clientWidth)+"s linear",transform:"translateX(-"+Math.ceil($("#initialDanmu")[0].clientWidth+s.clientWidth+10)+"px)",color:o,top:c+"px"};$(s).css(u)}}),$(".deleteButton")[0].onclick=function(){initialBarrage.length=0,$("#initialDanmu").remove()},$(".closeOrOpen")[0].onclick=function(){!0===(u=!u)?($("#initialDanmu").css("height","80%"),$(".switchButton").removeClass("off").addClass("on"),$(".switchButton").text("ON"),$(".closeOrOpen").removeClass("close"),$(".input").attr("disabled",!1)):($("#initialDanmu").css("height","0px"),$(".switchButton").removeClass("on").addClass("off"),$(".switchButton").text("OFF"),$(".closeOrOpen").addClass("close"),$(".input").attr("disabled",!0))}});